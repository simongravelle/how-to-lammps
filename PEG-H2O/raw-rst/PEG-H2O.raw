Pulling a PEG molecule in water
===============================

Here a single PEG molecule is immersed in water, and forces are applied to its 
ends in order to extend it.

Creating a box of water
-----------------------

.. image:: PEG-H2O/files/pureH2O/water.webp
   :width: 600
   
.. code-block:: python

# folder pureH2O file input.lammps
#space units real
#space atom_style full
#space bond_style harmonic
#space angle_style charmm
#space dihedral_style charmm
#space pair_style lj/cut/tip4p/long 1 2 1 1 0.1546 12.0
#space kspace_style pppm/tip4p 1.0e-4

# jump

Note: The atom_style `full` is required for charged molecules, and the pair_style `lj/cut/tip4p/long`
is a Lennard-Jones (cut) - Coulomb (long) pair style specifically adapted to 4 points water models,
which is what we want here. 

.. code-block::

#space region box block -40 40 -15 15 -15 15
#space create_box 7 box &
#space bond/types 6 &
#space angle/types 9 &
#space dihedral/types 14 &
#space extra/bond/per/atom 2 &
#space extra/angle/per/atom 1 &
#space extra/special/per/atom 2

# jump

.. code-block::

#space include ../PARM.lammps

# jump

.. code-block::

#space molecule h2omol H2OTip4p.txt
#space create_atoms 0 random 500 456415 NULL mol h2omol 454756
#space group H2O type 1 2
#space delete_atoms overlap 2 H2O H2O mol yes

# jump

.. code-block::

#space fix myshk H2O shake 1.0e-4 200 0 b 1 a 1 mol h2omol
#space fix mynpt all npt temp 300 300 100 iso 1 1 1000

# jump

.. code-block::

#space dump mydmp all atom 1000 dump.lammpstrj
#space variable mytemp equal temp
#space variable myvol equal vol
#space fix myat1 all ave/time 10 10 100 v_mytemp file temperature.dat
#space fix myat2 all ave/time 10 10 100 v_myvol file volume.dat

# jump

.. code-block::

#space timestep 1.0
#space thermo 1000
#space run 30000

# jump

.. code-block::

#space write_data H2O.data
